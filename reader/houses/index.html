<!–– Version 08112018
Author: Rohan Scott ––>
<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="style.css">
	<meta charset="UTF-8">
	<meta name="description" content="ROH'S HOUSE APPRAISER">
	<meta name="author" content="Rohan Scott">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="DataTables-1.10.20/datatables.min.css">
	<script src="jQuery-3.3.1/jquery-3.3.1.min.js"></script>
	<script src="DataTables-1.10.20/js/jquery.dataTables.min.js"></script>
	<script src="Chart/Chart.bundle.min.js"></script>
	<script src="Chart/Chart.min.js"></script>
	<script src="Select-1.3.1/js/dataTables.select.min.js"></script>
</head>
	<body>
		<div class="wrapper">
		  <div class="box header"><h1>ROH'S HOUSE APPRAISER</h1></div>
		  
		  <div class="box content"><h4>Enter Data</h4>
				<form onsubmit="return processData()" action="?" method="get" accept-charset=utf-8>
				
				Property type: <select name="consecutivecuts" id="consecutivecuts" style="font-size: 20px">
					<option value="no" selected>House</option>
					<option value="yes">Apartment</option>
					<option value="yes">Land</option>
				  </select><br><br>
				 Location: <select name="symmetrical" id="symmetrical" style="font-size: 20px">
					<option value="no" selected>Hobart under 5min to CBD</option>
					<option value="no">Hobart suburbs 5-15min to CBD</option>
					<option value="no">Hobart suburbs 15-30min to CBD</option>
					<option value="no">Hobart outskirts 30-60min to CBD</option>
					
					<option value="no">Launceston under 5min to CBD</option>
					<option value="no">Launceston suburbs 5-15min to CBD</option>
					<option value="no">Launceston suburbs 15-30min to CBD</option>
					<option value="no">Launceston outskirts 30-60min to CBD</option>
					
					<option value="no">North-north-west (Devonport, Ulverstone, Latrobe, Penguin, Burnie, Wynyard)</option>
					
					<option value="no">A shack location</option>
					
					<option value="no">In the middle of nowhere</option>
					
				  </select><br><br>
				Price: $<input type="number" step="1" name="numcuts" id="numcuts" style="font-size: 20px "><br><br> 
				Building area: <input type="number" step="1" name="numcuts" id="numcuts" style="font-size: 20px ">m²?
<br><br>
				Land area: <input type="number" step="1" name="numheights" id="numheights" style="font-size: 20px ">m²<br><br>  
				Number of bedrooms: <input type="number" step="1" name="numcuts" id="numcuts" style="font-size: 20px "><br><br>
				Number of bathrooms: <input type="number" step="1" name="numheights" id="numheights" style="font-size: 20px "><br><br>  
				<br><br>
				  <input type="submit" id="submit" name="submit" value="Submit" style="height:50px; width:100px; font-size:20px"><BR><BR>
				</form>
				<br><br><hr><br><br>

				<table id="locationSumaryTable" class="cell-border compact" width="100%"></table>

				
			</div>
			<div class="box sidebar"><h4>Results</h4>
			<p id="commentArea"></p>
			<p id="resultArea"></p>
			<script>
				
				Init();	
				
				function Init()
				{
					var table = $('#locationSumaryTable').DataTable( {
					"scrollCollapse": false,
					"paging": false,
					"info": false,
					"searching": false,
					"order": [[ 0, "desc" ]],
					select: 'single',
					columns: [
						{ title: "Location" },
						{ title: "Type" },
						{ title: "Bedrooms" },
						{ title: "Median Price" },
					]
					} );
					
					table.row.add( [
						"Launceston suburbs 5-15min to CBD","House","2","$480,000"
					] );
					table.row.add( [
						"Launceston suburbs 5-15min to CBD","House","3","$565,000"
					] );
					table.row.add( [
						"Launceston suburbs 5-15min to CBD","House","4","$665,000"
					] );
					
					table.draw();
				}
			
			
			
				function GetConsecutiveCutsSameHeight()
				{
					var input = document.getElementById('consecutivecuts');
					switch(input.value)
					{
						case("yes"): return(true); break;
						case("no"): return(false); break;
						default: return(-1);
					}
				}
				
				function GetSymmetrical()
				{
					var input = document.getElementById('symmetrical');
					switch(input.value)
					{
						case("yes"): return(true); break;
						case("no"): return(false); break;
						default: return(-1);
					}
				}
				
				function processData()
				{
					var consecutiveCutsSameHeight = GetConsecutiveCutsSameHeight();
					var symmetrical = GetSymmetrical();
					
					var numCuts = Number(document.getElementById('numcuts').value);
					var numHeights = Number(document.getElementById('numheights').value);
					var maxStep = Number(document.getElementById('maxstep').value);
					
					var resultsArray = CalculateResults(numCuts,numHeights,consecutiveCutsSameHeight,maxStep,symmetrical);
					var commentText ="";
					var commentText = "Number of combinations: "+resultsArray.length+"<br>";
					var randomInt = Math.floor(Math.random() * resultsArray.length) + 1;
					commentText+= "Here is a random combination for you to use: "+resultsArray[randomInt];
					
					
					document.getElementById("commentArea").innerHTML = commentText;
					document.getElementById("resultArea").innerHTML=="";
					var resultsText="";
					for(var i=0;i<resultsArray.length;i++)
					{
						resultsText += "<br>"+resultsArray[i];
					}
					document.getElementById("resultArea").innerHTML = resultsText;
					
					return false;
				}
				
				function CalculateResults(numCuts,numHeights,consecutiveCutsSameHeight,maxStep,symmetrical)
				{
					if(numHeights>9)
					{
						console.log("Invalid number of heights");
						return;
					}
					
					var combinationsArray = [];
					
					//get first combination
					var firstCombination = "";
					for(var i=0;i<numCuts;i++)
					{
						firstCombination+=1;
					}
					firstCombination = Number(firstCombination);
					
					//get last combination
					var lastCombination = "";
					for(var i=0;i<numCuts;i++)
					{
						lastCombination+=numHeights;
					}
					lastCombination = Number(lastCombination);
					
					var currentCombination = firstCombination;
					
					while(currentCombination<=lastCombination)
					{
						if(CheckValidCombination(currentCombination,numHeights,consecutiveCutsSameHeight,maxStep,symmetrical)==true)
						{
							combinationsArray.push(currentCombination);
						}
						currentCombination++;
					}
					
					return combinationsArray;
				}
				
				
				function CheckValidCombination(currentCombination,numHeights,consecutiveCutsSameHeight,maxStep,symmetrical)
				{
					var s = currentCombination.toString();
					for(var i=0;i<s.length;i++)
					{
						var n = Number(s[i])
						if(n>numHeights||n<1)
						{
							return false;
						}
									
						if(!consecutiveCutsSameHeight)
						{
							if(s[i+1])
							{
								if(Number(s[i+1])===n)
								{
									return false;
								}
							}
						}
						
						if(maxStep!=0)
						{
							if(s[i+1])
							{
								if(Math.abs(Number(s[i+1])-n)>maxStep)
								{
									return false;
								}
							}
						}
						
						if(symmetrical&&i<=(s.length)/2)
						{
							var j = s.length;
							if(s[j-1-i])
							{
								if(Number(s[j-1-i])!==n)
								{
									return false;
								}
							}
						}
					}
					return true;
				}
				
			</script>

			</div>
		  
		</div>
	</body>
</html>
